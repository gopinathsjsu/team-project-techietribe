<!DOCTYPE html>
<html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>BSPM Bank</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.min.css" />
    <link rel="stylesheet" href="stylesheets/style.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <script src="/js/user.js"></script>
</head>

<body>

    <script src="/js/signout.js"></script>
    <div class="header">
        <table style="width: 100%; margin: 5px;">
            <tr>
                <td style="border: none; width: 80%">
                    <p>BSPM Bank</p>
                </td>
                <td style="border: none;">
                    <div id="userFullName" style="text-align: center; font-size: 20px;"> </div>
                </td>
                <td style="border: none;">
                    <button class="btn btn-warning" id="signOut" onclick="singOut()">Sign Out</button>
                </td>
            </tr>
        </table>
    </div>

    <body>

        <h1>External transfer - One Time</h1>
        <p>Please fill out the below form</p>
        <div>
            <input type="text" name="id" id="id" placeholder="Id"/>
            <input type="text" name="destination_id" id="destination_id" placeholder="destination_id"/>
            <input type="text" name="amount" id="amount"placeholder="amount"/>
            <input type="text" name="description" id="description" placeholder="Description"/>
            <input type="text" name="payee_name" id="payee_name" placeholder="payee_name"/>
            <input type="text" name="RoutingNo" id="RoutingNo" placeholder="Routing Number"/>
            <div class="btn-block">
            <button type="submit" id="send"  onclick="clicked();" href="/">Send</button>
            </div>

        </div>
        <script>
            document
              .getElementById('send')
              .addEventListener('click', function () {
                var id = document.getElementById('id').value;
                var destination_id = document.getElementById('destination_id').value;
                var amount = document.getElementById('amount').value;
                var description = document.getElementById('description').value;
                var payee_name = document.getElementById('payee_name').value;
                var RoutingNo = document.getElementById('RoutingNo').value;
      
                var xhr = new XMLHttpRequest();
                var data = new FormData();
      
                var transaction_url =
                  'http://localhost:3000/externalTransfer?id=' +
                  id +
                  '&destination_id=' +
                  destination_id +
                  '&amount=' +
                  amount +
                  '&description=' +
                  description +
                  '&payee_name=' +
                  payee_name +
                  '&RoutingNo' +
                  RoutingNo
                  ;
      
                xhr.onreadystatechange = function () {
                  if (xhr.readyState == 4) {
                    if (xhr.status == 200) {
                      alert('Money Transferred Successfully !');
                    } else {
                      alert('failed to transfer!!');
                      window.location = '/';
                    }
                  } else {
                  }
                };
                xhr.open('POST', transaction_url, true);
                xhr.send(data);
                resetForm();
              });
            function clicked() {
              if (confirm('Trasfer  successful!!')) {
                yourformelement.submit();
              } else {
                return false;
              }
            }
      
            function resetForm() {
              document.getElementById('id').value = '';
              document.getElementById('destination_id').value = '';
              document.getElementById('amount').value = '';
              document.getElementById('description').value = '';
              document.getElementById('account').value = '';
              document.getElementById('payee_name').value = '';
              document.getElementById('RoutingNo').value = '';
            }
          </script>

    </body>

</html>